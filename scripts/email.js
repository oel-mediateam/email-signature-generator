/*
Email Signature Generator

@author: Ethan Lin
@url: https://github.com/oel-mediateam/uwextendedcampus-email-signature
@version: 1.0.0
@license: GNU GENERAL PUBLIC LICENSE v3

Email signature generator for UW Extended Campus
Copyright (C) 2019  Ethan Lin and UW Extended Campus

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <https://www.gnu.org/licenses/>.
*/
function titleCase(t){let e=t.toLowerCase().split(" "),s=["of","the"];for(let t=0;t<e.length;t++)s.includes(e[t])||(e[t]=e[t].charAt(0).toUpperCase()+e[t].substring(1));return e.join(" ")}function selectText(t){let e,s,n=document.getElementById(t);window.getSelection&&document.createRange&&(e=window.getSelection(),(s=document.createRange()).selectNodeContents(n),e.removeAllRanges(),e.addRange(s))}$(document).ready(function(){let t={firstName:"",middleInitial:"",lastName:"",credential:"",firstTitle:"",secondTitle:"",firstUnitProgram:"",firstWebsite:"",secondUnitProgram:"",secondWebsite:"",phoneNumber:"",email:"",valid:!1};function e(){0!=t.firstName.length&&0!=t.lastName.length?$("#emailInput").val(t.firstName.toLowerCase()+"."+t.lastName.toLowerCase()).blur():$("#emailInput").val("").blur()}function s(t){let e="",s="",n="";switch(t){case"success":e="signatureSuccess",n="success",s="<strong>Success!</strong> Your email signature has been copied to your computer's clipboard.";break;case"missing":e="signatureError",n="danger",s="<strong>Oops!</strong> Please enter all required information.";break;case"unsuccessful":e="signatureError",n="danger",s="<strong>Oh no!</strong> Your email signature was not copied successfully. Please try again.";break;case"error":e="signatureError",n="danger",s="<strong>Please try a different web browser</strong> Your current web browser does not supports copying to clipboard."}$("#signatureForm").before('<div id="'+e+'" class="alert alert-'+n+' alert-dismissible fade show" role="alert">'+s+'<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>');let i=window.setTimeout(function(){$("#"+e).alert("close"),window.clearInterval(i)},6e3)}$("#phoneInput").inputmask({mask:"(999) 999-9999"}),$("#firstNameInput").on("focus",function(){$("#firstName").addClass("mark")}),$("#firstNameInput").on("blur",function(){let s=this.value.trim();t.firstName=titleCase(s),this.value=t.firstName,$("#firstName").html(t.firstName).removeClass("text-muted mark"),0===s.length&&(this.value="",t.firstName="",$("#firstName").addClass("text-muted").removeClass("mark").html("First Name")),t.lastName.length&&e()}),$("#mInitialInput").on("focus",function(){$("#middleInitial").removeClass("d-none").addClass("mark")}),$("#mInitialInput").on("input paste",function(){let t=this.value.replace(/[^A-Za-z\.]/,"");this.value=t}),$("#mInitialInput").on("blur",function(){let e=this.value.replace(".","").trim(),s="";e.length?[...e].forEach(t=>s+="."!=t?t+".":""):s=e,t.middleInitial=s.toUpperCase(),this.value=t.middleInitial,$("#middleInitial").html(t.middleInitial).removeClass("text-muted mark"),0===e.length&&(this.value="",t.middleInitial="",$("#middleInitial").addClass("d-none text-muted").removeClass("mark").html("Middle Initial"))}),$("#lastNameInput").on("focus",function(){$("#lastName").addClass("mark")}),$("#lastNameInput").on("blur",function(){let s=this.value.trim();t.lastName=titleCase(s),this.value=t.lastName,$("#lastName").html(t.lastName).removeClass("text-muted mark"),0===s.length&&(this.value="",t.lastName="",$("#lastName").addClass("text-muted").removeClass("mark").html("Last Name")),t.firstName.length&&e()}),$("#credentialInput").on("focus",function(){$("#credential").removeClass("d-none").addClass("mark")}),$("#credentialInput").on("blur",function(){t.credential=this.value.trim(),$("#credential").html(", "+t.credential).removeClass("text-muted mark"),0===this.value.trim().length&&(this.value="",t.credential="",$("#credential").addClass("d-none text-muted").removeClass("mark").html(", Credential"))}),$("#titleInput").on("focus",function(){$("#title").addClass("mark")}),$("#titleInput").on("blur",function(){let e=this.value.trim();t.firstTitle=titleCase(e),this.value=t.firstTitle,$("#title").html(t.firstTitle).removeClass("text-muted mark"),0===e.length&&(this.value="",t.firstTitle="",$("#title").addClass("text-muted").removeClass("mark").html("Title"))}),$("#titleOptionalInput").on("focus",function(){$("#titleOptional").removeClass("d-none").addClass("mark")}),$("#titleOptionalInput").on("blur",function(){let e=this.value.trim();t.secondTitle=titleCase(e),this.value=t.secondTitle,$("#titleOptional").html(t.secondTitle+"<br>").removeClass("text-muted mark"),0===e.length&&(this.value="",t.secondTitle="",$("#titleOptional").addClass("d-none text-muted").removeClass("mark").html("Second Title<br>"))}),$("#businessUnitInput").on("focus",function(){$("#businessUnit").addClass("mark")}),$("#businessUnitInput").on("blur",function(){let e=this.value.trim();t.firstUnitProgram=titleCase(e),this.value=t.firstUnitProgram,$("#businessUnit").html(t.firstUnitProgram).removeClass("text-muted mark"),0===e.length&&(this.value="",t.firstUnitProgram="",$("#businessUnit").addClass("text-muted").removeClass("mark").html("Business Unit or Program"))}),$("#programWebsiteInput").on("focus",function(){$("#programWebsite").removeClass("d-none").addClass("mark")}),$("#programWebsiteInput").on("blur",function(){let e=this.value.trim().toLowerCase();e=e.replace(/http(s)?:\/\//gi,""),t.firstWebsite=e,this.value=t.firstWebsite,$("#programWebsite").html("| "+t.firstWebsite).removeClass("text-muted mark"),0===e.length&&(this.value="",t.firstWebsite="",$("#programWebsite").addClass("d-none text-muted").removeClass("mark").html("| Program Website"))}),$("#businessUnitOptionalInput, #programWebsiteOptionalInput").on("focus",function(){$("#2ndBusinessUnit").removeClass("d-none"),"businessUnitOptionalInput"===this.id&&$("#businessUnitOptional").removeClass("d-none").addClass("mark"),"programWebsiteOptionalInput"===this.id&&($("#businessUnitOptional").removeClass("d-none"),$("#programWebsiteOptional").removeClass("d-none").addClass("mark"))}),$("#businessUnitOptionalInput").on("blur",function(){let e=this.value.trim();t.secondUnitProgram=titleCase(e),this.value=t.secondUnitProgram,$("#businessUnitOptional").html(t.secondUnitProgram).removeClass("text-muted mark"),0===e.length&&(this.value="",t.secondUnitProgram="",$("#businessUnitOptional").addClass("text-muted").removeClass("mark").html("Second Business Unit or Program"),0==t.secondWebsite.length&&($("#2ndBusinessUnit").addClass("d-none"),$("#businessUnitOptional").addClass("d-none")))}),$("#programWebsiteOptionalInput").on("blur",function(){let e=this.value.trim().toLowerCase().replace(/http(s)?:\/\//gi,"");t.secondWebsite=e,this.value=t.secondWebsite,$("#programWebsiteOptional").html("| "+t.secondWebsite).removeClass("text-muted mark"),$("#businessUnitOptionalInput").attr("required",!0),0===e.length&&(this.value="",t.secondWebsite="",$("#programWebsiteOptional").addClass("d-none text-muted").removeClass("mark").html("| Program Website"),0==t.secondUnitProgram.length&&($("#2ndBusinessUnit").addClass("d-none"),$("#businessUnitOptional").addClass("d-none"),$("#businessUnitOptionalInput").attr("required",!1)))}),$("#phoneInput").on("focus",function(){$("#phoneOptional").removeClass("d-none").addClass("mark")}),$("#phoneInput").on("blur",function(){let e=this.value.trim();t.phoneNumber=e,this.value=t.phoneNumber,$("#phoneOptional").html(t.phoneNumber+" |").removeClass("text-muted mark"),0===e.length&&(this.value="",t.phoneNumber="",$("#phoneOptional").addClass("d-none text-muted").removeClass("mark").html("(123) 456-7890 |"))}),$("#emailInput").on("focus",function(){$("#email").addClass("mark")}),$("#emailInput").on("blur",function(){let e=this.value.trim().toLowerCase();t.email=e+"@uwex.edu",this.value=e,$("#email").html(t.email).removeClass("text-muted mark"),0===e.length&&(this.value="",t.email="",$("#email").addClass("text-muted").removeClass("mark").html("first.last@uwex.edu"))}),$("#signatureForm.needs-validation").on("submit",function(e){e.preventDefault(),e.stopPropagation(),t.valid=this.checkValidity(),$(this).addClass("was-validated"),t.valid?function(){let e=t.firstName+" "+t.middleInitial+" "+t.lastName,n=t.credential.length?", "+t.credential:"",i=t.firstUnitProgram+(t.firstWebsite.length?" | "+t.firstWebsite:""),a=(t.phoneNumber.length?t.phoneNumber+" | ":"")+t.email+" | ce.uwex.edu",l="<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;border:none'>";l+="<tr><td style='padding:0in'><p style='margin:0in;font-family:\"Calibri\",sans-serif;'><b><span style='font-size:11.0pt'>"+e+n+"</span></b></p></td></tr>",l+="<tr><td style='padding:0in'><p style='margin:0in;font-family:\"Calibri\",sans-serif;'><b><span style='font-size:11.0pt'>"+t.firstTitle+"</span></b></p></td></tr>",t.secondTitle.length&&(l+="<tr><td style='padding:0in'><p style='margin:0in;font-family:\"Calibri\",sans-serif;'><b><span style='font-size:11.0pt'>"+t.secondTitle+"</span></b></p></td></tr>");if(l+="<tr><td style='padding:0in'><p style='margin:0in;font-family:\"Calibri\",sans-serif;'><span style='font-size:11.0pt'>"+i+"</span></p></td></tr>",t.secondUnitProgram.length){let e=t.secondUnitProgram+(t.secondWebsite.length?" | "+t.secondWebsite:"");l+="<tr><td style='padding:0in'><p style='margin:0in;font-family:\"Calibri\",sans-serif;'><span style='font-size:11.0pt'>"+e+"</span></p></td></tr>"}l+="<tr><td style='padding:0in'><p style='margin:0in;font-family:\"Calibri\",sans-serif;'><span style='font-size:11.0pt'>"+a+"</span></p></td></tr>",l+="<tr><td style='padding:0in'><p style='margin:0in;font-family:\"Calibri\",sans-serif;'><span style='font-size:11.0pt'>&nbsp;</span></p></td></tr>",l+="<tr><td style='padding:0in'><p style='margin:0in;font-family:\"Calibri\",sans-serif;'><img width='330' height='95.39' src='images/logo.png' alt='Uinversity of Wisconsin Extended Campus'></p></td></tr>",l+="</table>",$("#artboard").html(l),function(){selectText("artboard");try{var t=document.execCommand("copy");s(t?"success":"unsuccessful")}catch(t){s("error")}window.getSelection().removeAllRanges()}()}():s("missing")}),$("#getSignatureBtn").on("click",function(t){return t.preventDefault(),t.stopPropagation(),$("#submitBtn").click(),!1}),$("#clearBtn").on("click",function(){$("input").not("input[type=button], input[type=submit]").val("").blur(),$("#signatureForm.needs-validation").removeClass("was-validated")})});